---
layout: post
title:  "7.7 模块划分与软件设计技术"
categories: 7.设计说明书
author: sysu-swsad-team
github: https://github.com/sysu-swsad-team
---

* content
{:toc}

## 前端技术应用

在前端我们使用了我们将用到下面几个框架与工具：

- [Vue.js](https://cn.vuejs.org/)
- [Vuex](https://vuex.vuejs.org/zh/)
- [Element-UI](https://element.eleme.cn/)
- [webpack](https://webpack.js.org/)

### Vue.js 组件化应用构建

我们选择 Vue.js 作为我们前端开发的主要框架。Vue.js 是一套构建用户界面的渐进式框架，它只关注视图层，采用自底向上增量开发的设计，目标是通过尽可能简单的 API 实现响应的数据绑定和组合的试图组件，并且 Vue 学习起来非常简单。

组件系统是 Vue 的一个重要概念，因为它是一种抽象，允许我们使用小型、独立和通常可复用的组件构建大型应用。跟大多数应用界面一样，在我们的前端应用界面系统可以抽象成下面的一个组件树，Vue 的组件化特性非常适合我们的应用构建。

![components]({{ '/styles/images/7.7/components.png' | prepend: site.baseurl }})

我们利用 Vue 的组件化特性，将前端界面划分为组件，比如登录/注册界面是一个组件，它又包含登录/注册的子组件。每个组件分文件管理，组件化构建应用可以让我们方便地复用组件。

### Vuex 状态管理

在构建 Vue 单页面应用时，Vuex 为我们提供了全局状态管理。在 state 中定义的数据后，我们可以在项目中任一个组件中进行获取或修改，并且你的修改可以得到全局的相应变更。当我们想要在项目中定义和使用全局变量时，使用 Vuex 是一个很好的解决方法。

- state：对数据的全局存储
- getter：和 Vue计算属性 computed 一样，来实时监听 state 值的变化 (最新状态)
- mutations：对数据的同步更改
- actions：对数据的异步更改

Vuex:

![vuex]({{ '/styles/images/7.7/vuex.png' | prepend: site.baseurl }})

### Element-UI 组件库

Element-UI 是一套基于 Vue 2.x 的组件库， 它提供了构建常见网站的的各种组件，如页面布局、按钮、表单、数据表格、导航菜单、对话框等。使用 Element-UI 能够快速构建一个单页面应用网站。

### webpack

通常，我们在构建网页应用时，会有繁杂的 JavaScript 代码和一大堆依赖包。简单来说，webpack 可以看做是模块打包机，它帮助分析项目结构，把项目的所有依赖文件打包成一个或多个浏览器可以识别的 JavaScript 文件。选择 webpack 来构建我们的应用能够方便管理、开发与部署。

### 前端文件结构

```sh
src
│   App.vue			# 程序入口
│   main.js			# main
│   utils.js
│
├───api				# axois api接口
│       api.js 			
│       index.js
│
├───assets			# 资源文件
│
├───mock 			# mock桩测试代码
│
├───page			# 组件
│   │   404.vue
│   │   Root.vue 
│   │
│   ├───Balance		# 充值与提现界面
│   │       Balance.vue
│   │
│   ├───components	# 应用组件
│   │       EditQuestionair.vue		        # 编辑问卷组件
│   │       ModuleCards.vue			# 模块卡组件
│   │       PageHead.vue			# 页头组件
│   │       ShowQuestionnaire.vue	        # 显示问卷组件
│   │
│   ├───Errand		# 跑腿办事页面
│   │       Errand.vue				# 跑腿办事主页主组件
│   │       Create.vue				# 创建任务组件子组件
│   │       Mine.vue				# 我的任务组件子组件
│   │
│   ├───Home		# 主页面
│   │       Home.vue				# 主页面主组件
│   │       Message.vue				# 我的信息子组件
│   │       PersonInfo.vue			# 个人信息子组件
│   │
│   ├───Login		# 登录/注册页面
│   │       Login.vue				# 登录/注册页面主组件
│   │       LoginForm.vue			# 登录表单子组件
│   │       RegisterForm.vue		        # 注册表单子组件
│   │
│   └───Questionnaire	# 问卷系统页面
│           Questionnaire.vue		        # 问卷系统主组件
│           Create.vue				# 创建问卷子组件
│           Mine.vue				# 我的问卷子组件
│
├───router		# 路由
│       index.js
│
├───styles		# 组件用到的样式（可复用）
│       pages.scss
│       vars.scss
│
└───vuex		# vuex状态管理
        store.js
```


## 软件设计技术

**1. 面向对象设计**

面向对象程序设计是一种程序设计范型，也是一种程序开发的方法。把对象作为程序的基本单元，将程序和数据封装其中，以此来提高软件的重用性、灵活性、和扩展性。面向对象设计可以看做是一种在程序中包含各种独立而又相互调用的对象的思想，这与传统的思想不同，传统的思想更侧重于把程序看作一系列函数的集合，而面向对象设计中的每一个对象都能够接收数据、处理数据和把数据传达给其他对象。

在后端开发中，我们使用了ORM，ORM全称是Object Relational Mapping（对象关系映射)，它在编程中把面向对象的概念跟数据库中表的概念对应起来，定义一个对象，就对应着一张表，这个对象的实例，就对应着表中的一条记录。ORM封装了底层的数据库操作，降低了编程难度，提高了代码的可读性和易维护性。

在模型[niffler-backend/niffler/questionnaire/models.py](https://github.com/sysu-swsad-team/niffler-backend/blob/master/niffler/questionnaire/models.py)中，我们定义了EmailVerify、Profile、Task等等几个类，这些类继承了django.db.models.Model，这些类定义了数据库的行为，每个类在数据库中都有一张表，我们在类中定义了一些属性，这些属性对应了表的不同字段，同时我们也在类中定义一些方法，让这些类不仅有数据库的存储和查询功能，还能进行一些计算，比如[Task.status](https://github.com/sysu-swsad-team/niffler-backend/blob/master/niffler/questionnaire/models.py#L142)这种计算属性，使得这个计算行为只存在模型中，而对视图和控制器是透明的，很好地揭藕，有利于扩展、移植和维护。

在视图[niffler-backend/niffler/questionnaire/views.py](https://github.com/sysu-swsad-team/niffler-backend/blob/master/niffler/questionnaire/views.py)中，我们根据[niffler-backend/niffler/questionnaire/models.py](https://github.com/sysu-swsad-team/niffler-backend/blob/master/niffler/questionnaire/models.py)的类定义相应的视图集（也是一个类，继承了rest_framework.viewsets.ViewSet），比如[ProfileView](https://github.com/sysu-swsad-team/niffler-backend/blob/master/niffler/questionnaire/views.py#L740)。对于一个视图集，我们可以重载rest_framework.viewsets.ViewSet的一些属性，如用于验证的[authentication_classes](https://github.com/sysu-swsad-team/niffler-backend/blob/master/niffler/questionnaire/views.py#L741)，我们也定义了一些方法，比如[retrieve()](https://github.com/sysu-swsad-team/niffler-backend/blob/master/niffler/questionnaire/views.py#L745)，[get()](https://github.com/sysu-swsad-team/niffler-backend/blob/master/niffler/questionnaire/views.py#L764)，[post()](https://github.com/sysu-swsad-team/niffler-backend/blob/master/niffler/questionnaire/views.py#L785)，对应不同的服务操作，而模型的不同类都会有retrieve、get、post这种相似的操作，相比将所有操作写成并列的视图函数这种做法，面向对象使得编程结构更加简洁和清晰，代码更具可读性，增删方法也更加灵活，也能够复用类似authentication_classes的相同属性，增加内聚性。